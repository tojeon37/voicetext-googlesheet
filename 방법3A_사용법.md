# 방법 3A: 자동 감지 + GUI 선택 사용법

## 🎯 **구현된 기능**

### **1. 자동 감지 기능**
- 프로그램 시작 시 허용된 스프레드시트를 자동으로 감지
- 고객이 스프레드시트 이름을 바꿔도 자동으로 찾아서 연결
- 우선순위에 따라 스프레드시트 선택

### **2. GUI 선택 기능**
- "자동 감지" 버튼으로 언제든지 스프레드시트 재감지
- 드롭다운에서 원하는 스프레드시트 선택
- 새로 생성한 스프레드시트도 자동으로 허용 목록에 추가

### **3. 보안 기능**
- `allowed_spreadsheets` 설정으로 접근 제한
- 다른 고객의 스프레드시트는 목록에서 보이지 않음
- 고객별로 다른 설정 파일 사용

## 📋 **사용 방법**

### **고객이 새 스프레드시트를 생성했을 때**

1. **프로그램 실행**
   - 프로그램이 자동으로 허용된 스프레드시트를 감지
   - 새 스프레드시트가 있으면 자동으로 목록에 추가

2. **자동 감지 버튼 사용**
   - "자동 감지" 버튼 클릭
   - 새로 생성된 스프레드시트가 자동으로 감지됨

3. **드롭다운에서 선택**
   - 스프레드시트 드롭다운에서 새 스프레드시트 선택
   - 자동으로 허용 목록에 추가되고 사용 가능

### **고객이 스프레드시트 이름을 변경했을 때**

1. **자동 감지**
   - 프로그램 시작 시 자동으로 새 이름의 스프레드시트 감지
   - 기존 설정이 자동으로 업데이트됨

2. **수동 감지**
   - "자동 감지" 버튼으로 즉시 새 스프레드시트 감지
   - 변경된 이름으로 자동 연결

## ⚙️ **설정 파일 예시**

### **A고객용 app_settings.json**
```json
{
  "last_sheet": "시트1",
  "last_cell": "A1",
  "last_row": 1,
  "last_col": 1,
  "last_spreadsheet": "A고객_음성기록",
  "allowed_spreadsheets": ["A고객_음성기록", "A고객_백업데이터"]
}
```

### **B고객용 app_settings.json**
```json
{
  "last_sheet": "시트1",
  "last_cell": "A1",
  "last_row": 1,
  "last_col": 1,
  "last_spreadsheet": "B고객_음성기록",
  "allowed_spreadsheets": ["B고객_음성기록"]
}
```

## 🔒 **보안 보장**

- **고객별 격리**: 각 고객은 자신의 스프레드시트만 접근 가능
- **자동 필터링**: 허용되지 않은 스프레드시트는 목록에서 제외
- **설정 파일 분리**: 고객별로 다른 설정 파일 사용

## 🚀 **장점**

1. **고객 편의성**: 스프레드시트 이름 변경 시 자동 감지
2. **개발자 편의성**: 설정 파일만 교체하면 배포 가능
3. **보안성**: 고객별 완전 격리
4. **유연성**: 새 스프레드시트 생성 시 자동 추가

## 📝 **주의사항**

- 고객이 새 스프레드시트를 생성하면 서비스 계정에 공유해야 함
- `allowed_spreadsheets` 목록은 자동으로 업데이트되지만, 수동으로도 관리 가능
- 프로그램을 종료하고 다시 시작하면 자동 감지가 다시 실행됨
