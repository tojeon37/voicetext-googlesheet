# 음성인식 구글시트 연동 프로그램 배포 방법 (방법 3A + Cloud Run 연동)

## 📋 개요
이 문서는 방법 3A(자동 감지 + GUI 선택) 기능이 적용된 음성인식 구글시트 연동 프로그램의 
고객별 배포 방법을 자세히 설명합니다.

## 🎯 방법 3A + Cloud Run 연동의 주요 특징
- 고객별 스프레드시트 격리 보안 강화
- 자동 감지 기능으로 스프레드시트 이름 변경 시 자동 연결
- GUI에 "자동 감지" 버튼으로 사용자 편의성 향상
- 새 스프레드시트 생성 시 자동 허용 목록 추가
- Cloud Run 서버를 통한 API 키 보안 강화
- 고령층 고객을 위한 사용자 친화적 인터페이스

## 🔧 배포 전 준비사항

### 1. 개발자 준비사항
- Google Cloud Console 프로젝트 설정 완료
- 서비스 계정 키 파일 생성 완료
- 각 고객별 구글 스프레드시트 생성 및 공유 완료

### 2. 고객별 구글 스프레드시트 설정
각 고객마다 다음 작업을 수행해야 합니다:

#### A고객용 스프레드시트 설정
1. 구글 스프레드시트 생성
   - 스프레드시트 이름: "A고객_음성기록" (또는 원하는 이름)
   - 시트 이름: "시트1" (기본값)

2. 서비스 계정 공유
   - 스프레드시트 우클릭 → 공유
   - 서비스 계정 이메일 추가: id-143@voicetext-472910.iam.gserviceaccount.com
   - 권한: 편집자

#### B고객용 스프레드시트 설정
1. 구글 스프레드시트 생성
   - 스프레드시트 이름: "B고객_음성기록" (또는 원하는 이름)
   - 시트 이름: "시트1" (기본값)

2. 서비스 계정 공유
   - 스프레드시트 우클릭 → 공유
   - 서비스 계정 이메일 추가: id-143@voicetext-472910.iam.gserviceaccount.com
   - 권한: 편집자

## 📦 배포 파일 구성

### 기본 배포 파일 목록 (Cloud Run 연동)
```
배포폴더/
├── VoiceRecognitionApp_ver2.exe          # 메인 실행 파일
├── app_settings.json                     # 고객별 설정 파일 (중요!)
├── 방법3A_사용법.md                      # 사용법 가이드
├── Cloud_Run_연동_가이드.md              # Cloud Run 연동 가이드
└── README.txt                           # 기본 설명서

주의: Google API 키 파일은 더 이상 필요하지 않습니다!
```

## 🎯 고객별 배포 방법

### 방법 1: 고객별 폴더 분리 (권장)

#### A고객 배포
1. 배포 폴더 생성
   ```
   A고객_배포폴더/
   ├── VoiceRecognitionApp_ver2.exe
   ├── app_settings.json (A고객용)
   ├── 방법3A_사용법.md
   ├── Cloud_Run_연동_가이드.md
   └── README.txt
   ```

2. A고객용 app_settings.json 설정
   ```json
   {
     "last_sheet": "시트1",
     "last_cell": "A1",
     "last_row": 1,
     "last_col": 1,
     "last_spreadsheet": "A고객_음성기록",
     "allowed_spreadsheets": ["A고객_음성기록"],
     "cloud_run_url": "https://voicetext-api-6qtb5op6hq-du.a.run.app"
   }
   ```

#### B고객 배포
1. 배포 폴더 생성
   ```
   B고객_배포폴더/
   ├── VoiceRecognitionApp_ver2.exe
   ├── app_settings.json (B고객용)
   ├── 방법3A_사용법.md
   ├── Cloud_Run_연동_가이드.md
   └── README.txt
   ```

2. B고객용 app_settings.json 설정
   ```json
   {
     "last_sheet": "시트1",
     "last_cell": "A1",
     "last_row": 1,
     "last_col": 1,
     "last_spreadsheet": "B고객_음성기록",
     "allowed_spreadsheets": ["B고객_음성기록"],
     "cloud_run_url": "https://voicetext-api-6qtb5op6hq-du.a.run.app"
   }
   ```

### 방법 2: 단일 배포 + 설정 파일 교체

1. 기본 배포 파일 준비
2. 고객별로 app_settings.json 파일만 교체
3. 배포 시 해당 고객의 설정 파일로 교체

## 🔒 보안 설정 상세

### 1. allowed_spreadsheets 설정의 중요성
이 설정이 고객별 격리의 핵심입니다:

```json
"allowed_spreadsheets": ["A고객_음성기록"]
```

- A고객은 "A고객_음성기록"만 접근 가능
- B고객의 스프레드시트는 목록에서 보이지 않음
- 다른 고객의 데이터에 접근할 수 없음

### 2. Cloud Run 서버를 통한 API 키 보안
- Google API 키가 고객 PC에 노출되지 않음
- 모든 API 호출이 Cloud Run 서버를 통해 관리
- 서버에서 API 키를 안전하게 보관

### 3. 자동 감지 기능의 보안
- 프로그램 시작 시 허용된 스프레드시트만 자동 감지
- "자동 감지" 버튼으로도 허용된 목록만 표시
- 새 스프레드시트 선택 시 자동으로 허용 목록에 추가

## 📋 배포 체크리스트

### 개발자 체크리스트
- [ ] 각 고객별 구글 스프레드시트 생성 완료
- [ ] 서비스 계정으로 각 스프레드시트 공유 완료
- [ ] Cloud Run 서버 배포 및 테스트 완료
- [ ] 고객별 app_settings.json 파일 준비 완료
- [ ] 배포 파일 압축 및 전달 준비 완료

### 고객별 체크리스트
- [ ] 구글 스프레드시트 생성 완료
- [ ] 서비스 계정 이메일로 스프레드시트 공유 완료
- [ ] 인터넷 연결 상태 확인 완료
- [ ] 배포 파일 다운로드 및 압축 해제 완료
- [ ] 프로그램 실행 테스트 완료
- [ ] Cloud Run 서버 연결 테스트 완료

## 🚀 배포 실행 단계

### 1단계: 개발자 준비
1. 각 고객별 구글 스프레드시트 생성
2. 서비스 계정으로 스프레드시트 공유
3. Cloud Run 서버 배포 및 테스트
4. 고객별 app_settings.json 파일 생성
5. 배포 파일 압축

### 2단계: 고객 배포
1. 고객에게 배포 파일 전달
2. 고객이 파일 압축 해제
3. 고객이 프로그램 실행
4. Cloud Run 서버 연결 확인
5. 자동 감지 기능으로 스프레드시트 연결 확인

### 3단계: 사용법 안내
1. "자동 감지" 버튼 사용법 설명
2. 스프레드시트 선택 방법 설명
3. 음성 인식 사용법 설명
4. Cloud Run 서버 연결 문제 해결 방법 안내
5. 네트워크 연결 문제 해결 방법 안내

## 🔧 고객 지원 방법

### 일반적인 문제 해결

#### 1. Cloud Run 서버 연결 실패
- 인터넷 연결 상태 확인
- 방화벽 설정 확인
- 서버 URL 확인
- 네트워크 관리자에게 문의

#### 2. 스프레드시트를 찾을 수 없는 경우
- "자동 감지" 버튼 클릭
- 스프레드시트 드롭다운에서 새로고침
- 구글 스프레드시트 공유 설정 확인

#### 3. 새 스프레드시트를 사용하고 싶은 경우
- 새 스프레드시트 생성
- 서비스 계정으로 공유
- "자동 감지" 버튼 클릭
- 드롭다운에서 새 스프레드시트 선택

#### 4. 스프레드시트 이름을 변경한 경우
- "자동 감지" 버튼 클릭
- 변경된 이름으로 자동 연결
- 또는 드롭다운에서 새 이름 선택

#### 5. 음성 인식 실패
- 마이크 연결 상태 확인
- 오디오 품질 확인
- 네트워크 연결 상태 확인
- Cloud Run 서버 상태 확인

### 고객 문의 대응
1. 문제 상황 파악
2. Cloud Run 서버 연결 상태 확인
3. "자동 감지" 버튼 사용 권장
4. 구글 스프레드시트 공유 설정 확인
5. 필요시 원격 지원 제공

## 📊 배포 후 모니터링

### 성공 지표
- 고객별 프로그램 정상 실행
- Cloud Run 서버 연결 정상
- 각 고객이 자신의 스프레드시트만 접근
- 음성 인식 기능 정상 작동
- 데이터가 올바른 스프레드시트에 저장

### 문제 발생 시 대응
- Cloud Run 서버 상태 확인
- 고객별 설정 파일 재확인
- 구글 스프레드시트 공유 설정 재확인
- 서비스 계정 권한 재확인
- 네트워크 연결 상태 확인
- 필요시 원격 지원 제공

## 🎯 방법 3A + Cloud Run 연동의 장점

### 고객 편의성
- 스프레드시트 이름 변경 시 자동 감지
- 새 스프레드시트 생성 시 자동 추가
- 직관적인 "자동 감지" 버튼
- 고령층도 쉽게 사용 가능
- API 키 관리 불필요

### 개발자 편의성
- 설정 파일만 교체하면 배포 가능
- 고객별 완전 격리로 보안 강화
- 자동화된 스프레드시트 관리
- 유지보수 작업 최소화
- 중앙화된 API 관리

### 보안성
- 고객별 스프레드시트 완전 격리
- 다른 고객 데이터 접근 불가
- 허용된 목록만 접근 가능
- 자동 필터링으로 보안 강화
- API 키 노출 위험 완전 제거
- Cloud Run 서버를 통한 중앙 관리

## 📞 지원 연락처

### 기술 지원
- 이메일: [개발자 이메일]
- 전화: [개발자 전화번호]
- 원격 지원: [원격 지원 도구]
- Cloud Run 서버 관련 문의
- API 연동 문제 해결

### 응답 시간
- 일반 문의: 24시간 이내
- 긴급 문의: 4시간 이내
- Cloud Run 서버 장애: 즉시 대응
- 원격 지원: 사전 예약 후 진행

## 📝 배포 완료 확인서

### 고객 확인사항
- [ ] 프로그램 정상 실행
- [ ] Cloud Run 서버 연결 확인
- [ ] 스프레드시트 자동 연결
- [ ] 음성 인식 기능 작동
- [ ] 데이터 저장 확인
- [ ] 사용법 이해 완료

### 개발자 확인사항
- [ ] Cloud Run 서버 배포 및 테스트 완료
- [ ] 고객별 설정 파일 적용
- [ ] 보안 설정 완료
- [ ] 사용법 안내 완료
- [ ] 지원 체계 구축
- [ ] 모니터링 체계 구축

---

이 배포 방법을 따라하면 방법 3A + Cloud Run 연동 기능이 적용된 음성인식 구글시트 연동 프로그램을 
안전하고 효율적으로 고객에게 배포할 수 있습니다.

## 🔄 주요 변경사항 요약

### 1. 보안 강화
- Google API 키가 고객 PC에 노출되지 않음
- Cloud Run 서버를 통한 중앙화된 API 관리
- 고객별 스프레드시트 완전 격리

### 2. 사용자 편의성 향상
- 스프레드시트 이름 변경 시 자동 감지
- 새 스프레드시트 생성 시 자동 추가
- "자동 감지" 버튼으로 쉬운 관리

### 3. 배포 간소화
- Google API 키 파일 불필요
- 설정 파일만 교체하면 배포 가능
- 중앙화된 서버 관리

배포 과정에서 문제가 발생하면 위의 지원 연락처로 문의해 주세요.
